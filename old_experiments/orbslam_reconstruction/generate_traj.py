import argparse
import sys
import os

def generate_traj(traj_file,ply_file):
    traj = open(traj_file)
    
    points = []    
    for line in traj:
        nums = line.split(" ")
        X = float(nums[1])
        Y = float(nums[2])
        Z = float(nums[3])
        points.append("%f %f %f\n"%(X,Y,Z))
    file = open(ply_file,"w")
    file.write('''ply
format ascii 1.0
element vertex %d
property float x
property float y
property float z
end_header
%s
'''%(len(points),"".join(points)))
    file.close()

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='''
    This script tries to visualize a txt file of the camera trajectory generated by ORBSLAM in 
    PLY format. 
    ''')

    parser.add_argument('traj_file', help='input trajectory file (format: txt)')
    parser.add_argument('ply_file', help='output PLY file (format: ply)')
    args = parser.parse_args()

    generate_traj(args.traj_file,args.ply_file)
    
